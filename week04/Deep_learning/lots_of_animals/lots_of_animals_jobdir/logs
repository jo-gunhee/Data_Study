2021-10-31 10:12:57 - dataprep - INFO - 
****** Running image validation ******

2021-10-31 10:13:39 - dataprep - INFO - 
****** Running samples validation ******

2021-10-31 10:13:39 - dataprep - INFO - Class distribution after validation:
2021-10-31 10:13:39 - dataprep - INFO - butterfly: 2112 (8.1%)
2021-10-31 10:13:39 - dataprep - INFO - cat: 1668 (6.4%)
2021-10-31 10:13:39 - dataprep - INFO - chicken: 3098 (11.8%)
2021-10-31 10:13:39 - dataprep - INFO - cow: 1866 (7.1%)
2021-10-31 10:13:39 - dataprep - INFO - dog: 4863 (18.6%)
2021-10-31 10:13:39 - dataprep - INFO - elephant: 1446 (5.5%)
2021-10-31 10:13:39 - dataprep - INFO - horse: 2623 (10.0%)
2021-10-31 10:13:39 - dataprep - INFO - sheep: 1820 (7.0%)
2021-10-31 10:13:39 - dataprep - INFO - spider: 4821 (18.4%)
2021-10-31 10:13:39 - dataprep - INFO - squirrel: 1862 (7.1%)
2021-10-31 10:13:39 - dataprep - INFO - Class mapping:
{0: 'butterfly', 1: 'cat', 2: 'chicken', 3: 'cow', 4: 'dog', 5: 'elephant', 6: 'horse', 7: 'sheep', 8: 'spider', 9: 'squirrel'}
2021-10-31 10:13:39 - dataprep - INFO - 
****** Creating train/val/test sets ******

2021-10-31 10:13:39 - dataprep - INFO - Split distribution: train: 0.65, val: 0.15, test: 0.2

2021-10-31 10:13:39 - dataprep - INFO - Partial split distribution: train: 0.65, val: 0.15, test: 0.20

2021-10-31 10:13:39 - dataprep - INFO - Train set:
2021-10-31 10:13:39 - dataprep - INFO - 0: 1373 (8.1%)
2021-10-31 10:13:39 - dataprep - INFO - 1: 1084 (6.4%)
2021-10-31 10:13:39 - dataprep - INFO - 2: 2013 (11.8%)
2021-10-31 10:13:39 - dataprep - INFO - 3: 1213 (7.1%)
2021-10-31 10:13:39 - dataprep - INFO - 4: 3160 (18.6%)
2021-10-31 10:13:39 - dataprep - INFO - 5: 940 (5.5%)
2021-10-31 10:13:39 - dataprep - INFO - 6: 1705 (10.0%)
2021-10-31 10:13:39 - dataprep - INFO - 7: 1183 (7.0%)
2021-10-31 10:13:39 - dataprep - INFO - 8: 3134 (18.4%)
2021-10-31 10:13:39 - dataprep - INFO - 9: 1211 (7.1%)
2021-10-31 10:13:39 - dataprep - INFO - Val set:
2021-10-31 10:13:39 - dataprep - INFO - 0: 317 (8.1%)
2021-10-31 10:13:39 - dataprep - INFO - 1: 250 (6.4%)
2021-10-31 10:13:39 - dataprep - INFO - 2: 465 (11.8%)
2021-10-31 10:13:39 - dataprep - INFO - 3: 280 (7.1%)
2021-10-31 10:13:39 - dataprep - INFO - 4: 730 (18.6%)
2021-10-31 10:13:39 - dataprep - INFO - 5: 217 (5.5%)
2021-10-31 10:13:39 - dataprep - INFO - 6: 393 (10.0%)
2021-10-31 10:13:39 - dataprep - INFO - 7: 273 (7.0%)
2021-10-31 10:13:39 - dataprep - INFO - 8: 723 (18.4%)
2021-10-31 10:13:39 - dataprep - INFO - 9: 279 (7.1%)
2021-10-31 10:13:39 - dataprep - INFO - Test set:
2021-10-31 10:13:39 - dataprep - INFO - 0: 422 (8.1%)
2021-10-31 10:13:39 - dataprep - INFO - 1: 334 (6.4%)
2021-10-31 10:13:39 - dataprep - INFO - 2: 620 (11.8%)
2021-10-31 10:13:39 - dataprep - INFO - 3: 373 (7.1%)
2021-10-31 10:13:39 - dataprep - INFO - 4: 973 (18.6%)
2021-10-31 10:13:39 - dataprep - INFO - 5: 289 (5.5%)
2021-10-31 10:13:39 - dataprep - INFO - 6: 525 (10.0%)
2021-10-31 10:13:39 - dataprep - INFO - 7: 364 (7.0%)
2021-10-31 10:13:39 - dataprep - INFO - 8: 964 (18.4%)
2021-10-31 10:13:39 - dataprep - INFO - 9: 372 (7.1%)
2021-10-31 10:13:39 - dataprep - INFO - 
****** Resizing images ******

2021-10-31 10:14:00 - dataprep - INFO - Stored 26179 resized images under collection_of_pic_resized
2021-10-31 10:14:00 - dataprep - INFO - Changed image directory to collection_of_pic_resized
2021-10-31 10:14:38 - training - INFO - Early stopping patience: 6
2021-10-31 10:14:38 - training - INFO - Learning rate patience: 2
2021-10-31 10:14:38 - training - INFO - 
****** Train dense layers ******

2021-10-31 10:54:57 - tf_keras - DEBUG - Epoch: 1 - val_loss: 0.2463 - val_acc: 0.9239 - loss: 1.3640 - acc: 0.6143
2021-10-31 10:54:57 - tf_keras - INFO - 
Epoch 00001 val_acc improved from -inf to 0.92386,
saving model to D:\jupyter\lots_of_animals\lots_of_animals_jobdir\models\model_mobilenet_01_0.924.hdf5
2021-10-31 11:34:32 - tf_keras - DEBUG - Epoch: 2 - val_loss: 0.1924 - val_acc: 0.9394 - loss: 0.5777 - acc: 0.8176 - lr: 0.0010
2021-10-31 11:34:32 - tf_keras - INFO - 
Epoch 00002 val_acc improved from 0.92386 to 0.93939,
saving model to D:\jupyter\lots_of_animals\lots_of_animals_jobdir\models\model_mobilenet_02_0.939.hdf5
2021-10-31 12:16:19 - tf_keras - DEBUG - Epoch: 3 - val_loss: 0.1742 - val_acc: 0.9437 - loss: 0.4549 - acc: 0.8521 - lr: 0.0010
2021-10-31 12:16:19 - tf_keras - INFO - 
Epoch 00003 val_acc improved from 0.93939 to 0.94372,
saving model to D:\jupyter\lots_of_animals\lots_of_animals_jobdir\models\model_mobilenet_03_0.944.hdf5
2021-10-31 12:16:20 - training - INFO - 
****** Train all layers ******

2021-10-31 14:34:43 - tf_keras - DEBUG - Epoch: 4 - val_loss: 0.2510 - val_acc: 0.9234 - loss: 0.2997 - acc: 0.9112
2021-10-31 14:34:43 - tf_keras - INFO - 
Epoch 00004 val_acc did not improve from 0.94372
2021-10-31 14:34:44 - evaluation - INFO - 
****** Load model ******

2021-10-31 14:34:48 - evaluation - INFO - loaded D:\jupyter\lots_of_animals\lots_of_animals_jobdir\models\model_mobilenet_03_0.944.hdf5
2021-10-31 14:34:48 - evaluation - INFO - 
****** Make prediction on test set ******

2021-10-31 14:44:20 - evaluation - INFO - 
****** Plot distribution on test set ******

2021-10-31 14:44:21 - evaluation - INFO - 
****** Plot classification report ******

2021-10-31 14:44:21 - evaluation - INFO -          	prec	rec	f1	support
2021-10-31 14:44:21 - evaluation - INFO - butterfly	0.97	0.92	0.95	422	
2021-10-31 14:44:21 - evaluation - INFO - cat      	1.00	0.85	0.92	334	
2021-10-31 14:44:21 - evaluation - INFO - chicken  	0.97	0.97	0.97	620	
2021-10-31 14:44:21 - evaluation - INFO - cow      	0.82	0.93	0.87	373	
2021-10-31 14:44:21 - evaluation - INFO - dog      	0.93	0.96	0.95	973	
2021-10-31 14:44:21 - evaluation - INFO - elephant 	0.99	0.89	0.94	289	
2021-10-31 14:44:21 - evaluation - INFO - horse    	0.92	0.93	0.93	525	
2021-10-31 14:44:21 - evaluation - INFO - sheep    	0.91	0.88	0.90	364	
2021-10-31 14:44:21 - evaluation - INFO - spider   	0.97	0.98	0.98	964	
2021-10-31 14:44:21 - evaluation - INFO - squirrel 	0.94	0.97	0.95	372	
2021-10-31 14:44:21 - evaluation - INFO - macro avg	0.94	0.93	0.93	5236	
2021-10-31 14:44:21 - evaluation - INFO - weighted avg	0.94	0.94	0.94	5236	
2021-10-31 14:44:21 - evaluation - INFO - 
****** Plot confusion matrix (recall) ******

2021-10-31 14:44:21 - evaluation - INFO - 
****** Plot confusion matrix (precision) ******

2021-10-31 14:44:22 - evaluation - INFO - 
****** Plot correct and wrong examples ******

